{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import SendInviteLinkForm from'components/forms/SendInviteLinkForm';import axios from\"axios\";import{useNavigate}from'react-router-dom';import ConfirmationPopup from'components/forms/ConfimationPopup';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PublishProjects(){var navigate=useNavigate();var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),popup=_React$useState2[0],setPopup=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),clients=_React$useState4[0],setClients=_React$useState4[1];var _React$useState5=React.useState(\"\"),_React$useState6=_slicedToArray(_React$useState5,2),selectedClient=_React$useState6[0],setSelectedClient=_React$useState6[1];var handleChange=function handleChange(client){setClients([client].concat(_toConsumableArray(clients)));};React.useEffect(function(){function fetchTableData(){return _fetchTableData.apply(this,arguments);}function _fetchTableData(){_fetchTableData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/api/users?role=CLIENT');case 3:response=_context.sent;setClients(response.data);console.log(response.data);console.log(clients);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));return _fetchTableData.apply(this,arguments);}fetchTableData();},[]);var handleYes=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete('/api/user/'+selectedClient);case 3:response=_context2.sent;_context2.t0=response.status;_context2.next=_context2.t0===200?7:_context2.t0===401?12:_context2.t0===404?15:_context2.t0===409?17:19;break;case 7:console.log(\"Deleted successfully\");setPopup(false);setClients(clients.filter(function(p){return p.email!==selectedClient;}));setSelectedClient(\"\");return _context2.abrupt(\"break\",21);case 12:console.log(\"Unauthorized to delete\");navigate(\"/signin\",{replace:true});return _context2.abrupt(\"break\",21);case 15:console.log(\"Cannot find the client\");return _context2.abrupt(\"break\",21);case 17:console.log(\"Cannot delete self\");return _context2.abrupt(\"break\",21);case 19:console.log(\"server error\");return _context2.abrupt(\"break\",21);case 21:_context2.next=26;break;case 23:_context2.prev=23;_context2.t1=_context2[\"catch\"](0);console.log(_context2.t1);case 26:case\"end\":return _context2.stop();}},_callee2,null,[[0,23]]);}));return function handleYes(){return _ref.apply(this,arguments);};}();var handleNo=function handleNo(event){setPopup(false);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(SendInviteLinkForm,{handleChange:handleChange}),popup&&/*#__PURE__*/_jsx(ConfirmationPopup,{message:\"Are you sure you want to delete this item ?\",onNo:handleNo,onYes:handleYes}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"S.No\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Client Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Client email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Created On\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:clients.map(function(row,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index}),/*#__PURE__*/_jsx(\"td\",{children:row.name}),/*#__PURE__*/_jsx(\"td\",{children:row.email}),/*#__PURE__*/_jsx(\"td\",{children:row.createdAt}),/*#__PURE__*/_jsx(\"td\",{children:row.role}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){setSelectedClient(row.email);setPopup(true);},children:\"Remove\"})})]},row._id);})})]})]});}export default PublishProjects;","map":{"version":3,"names":["React","SendInviteLinkForm","axios","useNavigate","ConfirmationPopup","jsx","_jsx","jsxs","_jsxs","PublishProjects","navigate","_React$useState","useState","_React$useState2","_slicedToArray","popup","setPopup","_React$useState3","_React$useState4","clients","setClients","_React$useState5","_React$useState6","selectedClient","setSelectedClient","handleChange","client","concat","_toConsumableArray","useEffect","fetchTableData","_fetchTableData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","sent","data","console","log","t0","stop","handleYes","_ref","_callee2","_callee2$","_context2","delete","status","filter","p","email","abrupt","replace","t1","handleNo","event","children","message","onNo","onYes","map","row","index","name","createdAt","role","onClick","_id"],"sources":["/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/src/components/project/PublishProjects.js"],"sourcesContent":["import React from 'react';\nimport SendInviteLinkForm from 'components/forms/SendInviteLinkForm';\nimport axios from \"axios\";\nimport { useNavigate } from 'react-router-dom';\nimport ConfirmationPopup from 'components/forms/ConfimationPopup';\n\nfunction PublishProjects() {\n\n  const navigate = useNavigate();\n  const [popup, setPopup] = React.useState(false);\n  const [clients, setClients] = React.useState([]);\n  const [selectedClient , setSelectedClient] = React.useState(\"\");\n  \n  const handleChange = (client) => {\n    setClients([client, ...clients]);\n  }\n\n  React.useEffect(() => {\n    async function fetchTableData() {\n      try {\n        const response = await axios.get('/api/users?role=CLIENT');\n        setClients(response.data);\n        console.log(response.data);\n        console.log(clients);\n      } catch (error) {\n        console.log(error);\n      }\n    }\n      \n    fetchTableData();\n  }, []);\n\n\n  const handleYes = async() => {\n    try {\n      const response = await axios.delete('/api/user/'+ selectedClient);\n      switch (response.status) {\n        case (200):\n          console.log(\"Deleted successfully\");\n          setPopup(false);\n          setClients(clients.filter(p => p.email !== selectedClient));\n          setSelectedClient(\"\");\n          break;\n        case (401):\n          console.log(\"Unauthorized to delete\");\n          navigate(\"/signin\" , {replace: true});\n          break;\n\n        case(404):\n          console.log(\"Cannot find the client\");\n          break;\n\n        case(409):\n          console.log(\"Cannot delete self\");\n          break;\n        \n        default:\n          console.log(\"server error\");\n          break;\n      }\n      \n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  const handleNo = (event) => {\n    setPopup(false);\n  }\n\n  return (\n    <div>\n      <SendInviteLinkForm handleChange={handleChange} />\n      {popup && <ConfirmationPopup message=\"Are you sure you want to delete this item ?\"  onNo={handleNo} onYes={handleYes}/>}\n      <table>\n      {/* table headers */}\n      <thead>\n        <tr>\n          <th>S.No</th>\n          <th>Client Name</th>\n          <th>Client email</th>\n          <th>Created On</th>\n          <th>Role</th>\n          <th>Actions</th>\n        </tr>\n      </thead>\n      <tbody>\n        {clients.map((row, index) => {\n          return(<tr key={row._id}>\n            {/* table rows */}\n            <td>{index}</td>\n            <td>{row.name}</td>\n            <td>{row.email}</td>\n            <td>{row.createdAt}</td>\n            <td>{row.role}</td>\n            <td>\n              <button onClick={() => {setSelectedClient(row.email); setPopup(true);}}>Remove</button>\n            </td>\n          </tr>\n          );\n        })}\n      </tbody>\n    </table>\n    </div>\n  );\n}\n\nexport default PublishProjects;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}