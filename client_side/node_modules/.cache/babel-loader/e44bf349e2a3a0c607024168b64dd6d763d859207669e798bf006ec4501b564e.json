{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function StageTwo(_ref){var data=_ref.data,setData=_ref.setData;var navigate=useNavigate();var assignedProjects=data.assignedProject;var students=data.users;var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),selectedStudent=_React$useState2[0],setSelectedStudent=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),preferences=_React$useState4[0],setPreferences=_React$useState4[1];React.useEffect(function(){function getPreferences(){return _getPreferences.apply(this,arguments);}function _getPreferences(){_getPreferences=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/preference/\".concat(data.name));case 3:response=_context.sent;console.log(response.data);setPreferences(response.data);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log({err:_context.t0});case 11:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return _getPreferences.apply(this,arguments);}getPreferences();},[data]);var assignedProjectToStudent=function assignedProjectToStudent(userId){if(!Array.isArray(assignedProjects)){return'-';}var assignedProject=assignedProjects.find(function(ap){return ap.student.toString()===userId.toString();});return assignedProject?assignedProject.project.name:'-';};var isPreferenceSet=function isPreferenceSet(userId){if(!Array.isArray(preferences)){return'NO';}var studentPreferences=preferences.find(function(preference){return preference.student._id===userId;});if(studentPreferences&&studentPreferences.projectPreferences.length>0){return'Yes';}return'No';};var isAssignButtonEnabled=function isAssignButtonEnabled(userId){if(!Array.isArray(preferences)){return false;}var studentPreferences=preferences.find(function(preference){return preference.student._id===userId;});if(studentPreferences&&studentPreferences.projectPreferences.length>0){return true;}return false;};var renderPopup=function renderPopup(){var _preferences$find,_students$find;if(!preferences){return/*#__PURE__*/_jsx(\"div\",{});}var selectedStudentPreferences=(_preferences$find=preferences.find(function(preference){return preference.student._id===selectedStudent;}))===null||_preferences$find===void 0?void 0:_preferences$find.projectPreferences;return/*#__PURE__*/_jsx(\"div\",{className:\"popup\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup-content\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Assign Project to \",(_students$find=students.find(function(student){return student._id===selectedStudent;}))===null||_students$find===void 0?void 0:_students$find.name]}),selectedStudentPreferences&&selectedStudentPreferences.map(function(preference){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:preference.project.name}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Rank: \",preference.rank]})]},preference.project._id);}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"select\",{name:\"project\",id:\"project-select\",children:data.projects.map(function(project){return/*#__PURE__*/_jsx(\"option\",{value:project._id,children:project.name},project._id);})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleSavePopup(document.getElementById(\"project-select\").value);},children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClose,children:\"Cancel\"})]})]})});};var handleClick=function handleClick(studentId){setSelectedStudent(studentId);{studentId&&renderPopup();}};var handleSavePopup=function handleSavePopup(projectId){// Do something with the selected project and studentId\nconsole.log(projectId,selectedStudent);setSelectedStudent(null);};var handleClose=function handleClose(){setSelectedStudent(null);};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Student Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Student Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Preferences Set\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Assigned Project\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:students.map(function(student){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:student.name}),/*#__PURE__*/_jsx(\"td\",{children:student.email}),/*#__PURE__*/_jsx(\"td\",{children:isPreferenceSet(student._id)}),/*#__PURE__*/_jsx(\"td\",{children:assignedProjectToStudent(student._id)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleClick(student._id);},disabled:!isAssignButtonEnabled(student._id),children:\"Assign\"})})]});})})]})});}","map":{"version":3,"names":["React","useState","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","StageTwo","_ref","data","setData","navigate","assignedProjects","assignedProject","students","users","_React$useState","_React$useState2","_slicedToArray","selectedStudent","setSelectedStudent","_React$useState3","_React$useState4","preferences","setPreferences","useEffect","getPreferences","_getPreferences","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","concat","name","sent","console","log","t0","err","stop","assignedProjectToStudent","userId","Array","isArray","find","ap","student","toString","project","isPreferenceSet","studentPreferences","preference","_id","projectPreferences","length","isAssignButtonEnabled","renderPopup","_preferences$find","_students$find","selectedStudentPreferences","className","children","map","rank","id","projects","value","onClick","handleSavePopup","document","getElementById","handleClose","handleClick","studentId","projectId","email","disabled"],"sources":["/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/src/components/courses/stages/StageTwo.js"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\n\nexport default function StageTwo({data , setData}) {\n    const navigate = useNavigate();\n    const assignedProjects = data.assignedProject;\n    const students = data.users;\n\n    const [selectedStudent, setSelectedStudent] = React.useState(null);\n    const [preferences,setPreferences] = React.useState([]);\n\n    React.useEffect(()=>{\n        async function getPreferences() {\n            try {\n                const response = await axios.get(`/preference/${data.name}`);\n                console.log(response.data);\n                setPreferences(response.data);\n            } catch (err) {\n                console.log({err});\n            }\n        }\n        getPreferences();\n    },[data]);\n\n\n    const assignedProjectToStudent = (userId) => {\n        if (!Array.isArray(assignedProjects)) {\n            return '-';\n        }\n        const assignedProject = assignedProjects.find((ap) => ap.student.toString() === userId.toString());\n        return assignedProject ? assignedProject.project.name : '-';\n    };\n  \n    \n    const isPreferenceSet = (userId) => {\n        if (!Array.isArray(preferences)) {\n            return 'NO';\n        }\n        const studentPreferences = preferences.find(\n          (preference) => preference.student._id === userId\n        );\n        if (studentPreferences && studentPreferences.projectPreferences.length > 0) {\n          return 'Yes';\n        }\n        return 'No';\n    };\n\n    const isAssignButtonEnabled = (userId) => {\n        if (!Array.isArray(preferences)) {\n            return false;\n        }\n\n        const studentPreferences = preferences.find(\n          (preference) => preference.student._id === userId\n        );\n        if (studentPreferences && studentPreferences.projectPreferences.length > 0) {\n          return true;\n        }\n        return false;\n    };\n\n    const renderPopup = () => {\n        if (!preferences) {\n            return <div></div>\n        }\n        const selectedStudentPreferences = preferences.find((preference) => preference.student._id === selectedStudent)?.projectPreferences;\n        return (\n          <div className=\"popup\">\n            <div className=\"popup-content\">\n              <h3>Assign Project to {students.find((student) => student._id === selectedStudent)?.name}</h3>\n              {selectedStudentPreferences && selectedStudentPreferences.map((preference) => (\n                <div key={preference.project._id}>\n                  <p>{preference.project.name}</p>\n                  <p>Rank: {preference.rank}</p>\n                </div>\n              ))}\n              <div>\n                <select name=\"project\" id=\"project-select\">\n                  {data.projects.map((project) => (\n                    <option key={project._id} value={project._id}>{project.name}</option>\n                  ))}\n                </select>\n                <button onClick={() => handleSavePopup(document.getElementById(\"project-select\").value)}>Save</button>\n                <button onClick={handleClose}>Cancel</button>\n              </div>\n            </div>\n          </div>\n        )\n      }\n\n    const handleClick = (studentId) =>{\n        setSelectedStudent(studentId);\n        {studentId && renderPopup()}\n    }\n\n    const handleSavePopup = (projectId) => {\n        // Do something with the selected project and studentId\n        console.log(projectId, selectedStudent);\n        setSelectedStudent(null);\n      }\n\n    const handleClose = () => {\n        setSelectedStudent(null);\n    }\n    \n    return (\n        <div>\n          <table>\n            <thead>\n              <tr>\n                <th>Student Name</th>\n                <th>Student Email</th>\n                <th>Preferences Set</th>\n                <th>Assigned Project</th>\n                <th>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {students.map((student) => (\n                <tr>\n                    <td>{student.name}</td>\n                    <td>{student.email}</td>\n                    <td>{isPreferenceSet(student._id)}</td>\n                    <td>{assignedProjectToStudent(student._id)}</td>\n                    <td>\n                      <button \n                        onClick={()=>handleClick(student._id)} \n                        disabled={!isAssignButtonEnabled(student._id)}\n                      >\n                        Assign\n                      </button> \n                    </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n    );\n}\n"],"mappings":"wdAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE/C,cAAe,SAAS,CAAAC,QAAQA,CAAAC,IAAA,CAAmB,IAAjB,CAAAC,IAAI,CAAAD,IAAA,CAAJC,IAAI,CAAGC,OAAO,CAAAF,IAAA,CAAPE,OAAO,CAC5C,GAAM,CAAAC,QAAQ,CAAGT,WAAW,EAAE,CAC9B,GAAM,CAAAU,gBAAgB,CAAGH,IAAI,CAACI,eAAe,CAC7C,GAAM,CAAAC,QAAQ,CAAGL,IAAI,CAACM,KAAK,CAE3B,IAAAC,eAAA,CAA8CjB,KAAK,CAACC,QAAQ,CAAC,IAAI,CAAC,CAAAiB,gBAAA,CAAAC,cAAA,CAAAF,eAAA,IAA3DG,eAAe,CAAAF,gBAAA,IAAEG,kBAAkB,CAAAH,gBAAA,IAC1C,IAAAI,gBAAA,CAAqCtB,KAAK,CAACC,QAAQ,CAAC,EAAE,CAAC,CAAAsB,gBAAA,CAAAJ,cAAA,CAAAG,gBAAA,IAAhDE,WAAW,CAAAD,gBAAA,IAACE,cAAc,CAAAF,gBAAA,IAEjCvB,KAAK,CAAC0B,SAAS,CAAC,UAAI,SACD,CAAAC,cAAcA,CAAA,SAAAC,eAAA,CAAAC,KAAA,MAAAC,SAAA,YAAAF,gBAAA,EAAAA,eAAA,CAAAG,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAA7B,SAAAC,QAAA,MAAAC,QAAA,QAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAE+B,CAAAtC,KAAK,CAACuC,GAAG,gBAAAC,MAAA,CAAgBhC,IAAI,CAACiC,IAAI,EAAG,QAAtDR,QAAQ,CAAAG,QAAA,CAAAM,IAAA,CACdC,OAAO,CAACC,GAAG,CAACX,QAAQ,CAACzB,IAAI,CAAC,CAC1Be,cAAc,CAACU,QAAQ,CAACzB,IAAI,CAAC,CAAC4B,QAAA,CAAAE,IAAA,iBAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAS,EAAA,CAAAT,QAAA,aAE9BO,OAAO,CAACC,GAAG,CAAC,CAACE,GAAG,CAAAV,QAAA,CAAAS,EAAA,CAAC,CAAC,CAAC,yBAAAT,QAAA,CAAAW,IAAA,MAAAf,OAAA,gBAE1B,UAAAN,eAAA,CAAAC,KAAA,MAAAC,SAAA,GACDH,cAAc,EAAE,CACpB,CAAC,CAAC,CAACjB,IAAI,CAAC,CAAC,CAGT,GAAM,CAAAwC,wBAAwB,CAAG,QAA3B,CAAAA,wBAAwBA,CAAIC,MAAM,CAAK,CACzC,GAAI,CAACC,KAAK,CAACC,OAAO,CAACxC,gBAAgB,CAAC,CAAE,CAClC,MAAO,GAAG,CACd,CACA,GAAM,CAAAC,eAAe,CAAGD,gBAAgB,CAACyC,IAAI,CAAC,SAACC,EAAE,QAAK,CAAAA,EAAE,CAACC,OAAO,CAACC,QAAQ,EAAE,GAAKN,MAAM,CAACM,QAAQ,EAAE,GAAC,CAClG,MAAO,CAAA3C,eAAe,CAAGA,eAAe,CAAC4C,OAAO,CAACf,IAAI,CAAG,GAAG,CAC/D,CAAC,CAGD,GAAM,CAAAgB,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAAIR,MAAM,CAAK,CAChC,GAAI,CAACC,KAAK,CAACC,OAAO,CAAC7B,WAAW,CAAC,CAAE,CAC7B,MAAO,IAAI,CACf,CACA,GAAM,CAAAoC,kBAAkB,CAAGpC,WAAW,CAAC8B,IAAI,CACzC,SAACO,UAAU,QAAK,CAAAA,UAAU,CAACL,OAAO,CAACM,GAAG,GAAKX,MAAM,GAClD,CACD,GAAIS,kBAAkB,EAAIA,kBAAkB,CAACG,kBAAkB,CAACC,MAAM,CAAG,CAAC,CAAE,CAC1E,MAAO,KAAK,CACd,CACA,MAAO,IAAI,CACf,CAAC,CAED,GAAM,CAAAC,qBAAqB,CAAG,QAAxB,CAAAA,qBAAqBA,CAAId,MAAM,CAAK,CACtC,GAAI,CAACC,KAAK,CAACC,OAAO,CAAC7B,WAAW,CAAC,CAAE,CAC7B,MAAO,MAAK,CAChB,CAEA,GAAM,CAAAoC,kBAAkB,CAAGpC,WAAW,CAAC8B,IAAI,CACzC,SAACO,UAAU,QAAK,CAAAA,UAAU,CAACL,OAAO,CAACM,GAAG,GAAKX,MAAM,GAClD,CACD,GAAIS,kBAAkB,EAAIA,kBAAkB,CAACG,kBAAkB,CAACC,MAAM,CAAG,CAAC,CAAE,CAC1E,MAAO,KAAI,CACb,CACA,MAAO,MAAK,CAChB,CAAC,CAED,GAAM,CAAAE,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAA,CAAS,KAAAC,iBAAA,CAAAC,cAAA,CACtB,GAAI,CAAC5C,WAAW,CAAE,CACd,mBAAOnB,IAAA,UAAW,CACtB,CACA,GAAM,CAAAgE,0BAA0B,EAAAF,iBAAA,CAAG3C,WAAW,CAAC8B,IAAI,CAAC,SAACO,UAAU,QAAK,CAAAA,UAAU,CAACL,OAAO,CAACM,GAAG,GAAK1C,eAAe,GAAC,UAAA+C,iBAAA,iBAA5EA,iBAAA,CAA8EJ,kBAAkB,CACnI,mBACE1D,IAAA,QAAKiE,SAAS,CAAC,OAAO,CAAAC,QAAA,cACpBhE,KAAA,QAAK+D,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BhE,KAAA,OAAAgE,QAAA,EAAI,oBAAkB,EAAAH,cAAA,CAACrD,QAAQ,CAACuC,IAAI,CAAC,SAACE,OAAO,QAAK,CAAAA,OAAO,CAACM,GAAG,GAAK1C,eAAe,GAAC,UAAAgD,cAAA,iBAA3DA,cAAA,CAA6DzB,IAAI,GAAM,CAC7F0B,0BAA0B,EAAIA,0BAA0B,CAACG,GAAG,CAAC,SAACX,UAAU,qBACvEtD,KAAA,QAAAgE,QAAA,eACElE,IAAA,MAAAkE,QAAA,CAAIV,UAAU,CAACH,OAAO,CAACf,IAAI,EAAK,cAChCpC,KAAA,MAAAgE,QAAA,EAAG,QAAM,CAACV,UAAU,CAACY,IAAI,GAAK,GAFtBZ,UAAU,CAACH,OAAO,CAACI,GAAG,CAG1B,EACP,CAAC,cACFvD,KAAA,QAAAgE,QAAA,eACElE,IAAA,WAAQsC,IAAI,CAAC,SAAS,CAAC+B,EAAE,CAAC,gBAAgB,CAAAH,QAAA,CACvC7D,IAAI,CAACiE,QAAQ,CAACH,GAAG,CAAC,SAACd,OAAO,qBACzBrD,IAAA,WAA0BuE,KAAK,CAAElB,OAAO,CAACI,GAAI,CAAAS,QAAA,CAAEb,OAAO,CAACf,IAAI,EAA9Ce,OAAO,CAACI,GAAG,CAA6C,EACtE,CAAC,EACK,cACTzD,IAAA,WAAQwE,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAAC,eAAe,CAACC,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC,CAACJ,KAAK,CAAC,EAAC,CAAAL,QAAA,CAAC,MAAI,EAAS,cACtGlE,IAAA,WAAQwE,OAAO,CAAEI,WAAY,CAAAV,QAAA,CAAC,QAAM,EAAS,GACzC,GACF,EACF,CAEV,CAAC,CAEH,GAAM,CAAAW,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAIC,SAAS,CAAI,CAC9B9D,kBAAkB,CAAC8D,SAAS,CAAC,CAC7B,CAACA,SAAS,EAAIjB,WAAW,EAAE,EAC/B,CAAC,CAED,GAAM,CAAAY,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAAIM,SAAS,CAAK,CACnC;AACAvC,OAAO,CAACC,GAAG,CAACsC,SAAS,CAAEhE,eAAe,CAAC,CACvCC,kBAAkB,CAAC,IAAI,CAAC,CAC1B,CAAC,CAEH,GAAM,CAAA4D,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAA,CAAS,CACtB5D,kBAAkB,CAAC,IAAI,CAAC,CAC5B,CAAC,CAED,mBACIhB,IAAA,QAAAkE,QAAA,cACEhE,KAAA,UAAAgE,QAAA,eACElE,IAAA,UAAAkE,QAAA,cACEhE,KAAA,OAAAgE,QAAA,eACElE,IAAA,OAAAkE,QAAA,CAAI,cAAY,EAAK,cACrBlE,IAAA,OAAAkE,QAAA,CAAI,eAAa,EAAK,cACtBlE,IAAA,OAAAkE,QAAA,CAAI,iBAAe,EAAK,cACxBlE,IAAA,OAAAkE,QAAA,CAAI,kBAAgB,EAAK,cACzBlE,IAAA,OAAAkE,QAAA,CAAI,SAAO,EAAK,GACb,EACC,cACRlE,IAAA,UAAAkE,QAAA,CACGxD,QAAQ,CAACyD,GAAG,CAAC,SAAChB,OAAO,qBACpBjD,KAAA,OAAAgE,QAAA,eACIlE,IAAA,OAAAkE,QAAA,CAAKf,OAAO,CAACb,IAAI,EAAM,cACvBtC,IAAA,OAAAkE,QAAA,CAAKf,OAAO,CAAC6B,KAAK,EAAM,cACxBhF,IAAA,OAAAkE,QAAA,CAAKZ,eAAe,CAACH,OAAO,CAACM,GAAG,CAAC,EAAM,cACvCzD,IAAA,OAAAkE,QAAA,CAAKrB,wBAAwB,CAACM,OAAO,CAACM,GAAG,CAAC,EAAM,cAChDzD,IAAA,OAAAkE,QAAA,cACElE,IAAA,WACEwE,OAAO,CAAE,SAAAA,QAAA,QAAI,CAAAK,WAAW,CAAC1B,OAAO,CAACM,GAAG,CAAC,EAAC,CACtCwB,QAAQ,CAAE,CAACrB,qBAAqB,CAACT,OAAO,CAACM,GAAG,CAAE,CAAAS,QAAA,CAC/C,QAED,EAAS,EACN,GACJ,EACN,CAAC,EACI,GACF,EACJ,CAEd"},"metadata":{},"sourceType":"module","externalDependencies":[]}