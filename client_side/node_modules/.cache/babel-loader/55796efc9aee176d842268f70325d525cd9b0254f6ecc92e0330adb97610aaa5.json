{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useNavigate}from\"react-router-dom\";import ConfirmationPopup from\"./ConfimationPopup\";import ErrorMessagePopup from\"./ErrorMessagePopup\";import React from\"react\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function DeleteStudentForm(_ref){var student=_ref.student,data=_ref.data,setData=_ref.setData;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var navigate=useNavigate();function onYes(){return _onYes.apply(this,arguments);}function _onYes(){_onYes=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,updateUsers,updatedData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;console.log(data._id);console.log(student._id);_context.next=5;return axios.delete(\"/api/courses/student\",{data:{courseId:data._id,studentId:student._id},headers:{'Content-Type':'application/json'}});case 5:response=_context.sent;updateUsers=data.users.filter(function(user){return user._id!==student._id;});updatedData=_objectSpread(_objectSpread({},data),{},{users:updateUsers});setData(updatedData);_context.next=25;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);_context.t1=_context.t0.response.status;_context.next=_context.t1===401?16:_context.t1===404?19:22;break;case 16:setOpen(false);navigate(\"/sigin\",{replace:true});return _context.abrupt(\"break\",25);case 19:setOpen(false);/*#__PURE__*/_jsx(ErrorMessagePopup,{message:\"Student/ course not found\"});return _context.abrupt(\"break\",25);case 22:setOpen(false);/*#__PURE__*/_jsx(ErrorMessagePopup,{message:\"\"});return _context.abrupt(\"break\",25);case 25:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return _onYes.apply(this,arguments);}function onNo(){setOpen(false);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setOpen(true);},children:\"Delete\"}),open&&/*#__PURE__*/_jsx(ConfirmationPopup,{message:\"Are you sure you want to delete this student ?\",onYes:onYes,onNo:onNo})]});}","map":{"version":3,"names":["useNavigate","ConfirmationPopup","ErrorMessagePopup","React","axios","jsx","_jsx","jsxs","_jsxs","DeleteStudentForm","_ref","student","data","setData","_React$useState","useState","_React$useState2","_slicedToArray","open","setOpen","navigate","onYes","_onYes","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","updateUsers","updatedData","wrap","_callee$","_context","prev","next","console","log","_id","delete","courseId","studentId","headers","sent","users","filter","user","_objectSpread","t0","t1","status","replace","abrupt","message","stop","onNo","children","onClick"],"sources":["/Users/cpms/Desktop/Capstone-Project-Management-System/client_side/src/components/forms/DeleteStudentForm.js"],"sourcesContent":["import { useNavigate } from \"react-router-dom\";\nimport ConfirmationPopup from \"./ConfimationPopup\";\nimport ErrorMessagePopup from \"./ErrorMessagePopup\";\nimport React from \"react\";\nimport axios from \"axios\";\n\nexport default function DeleteStudentForm({student, data, setData}) {\n\n    const [open, setOpen] = React.useState(false);\n    const navigate = useNavigate();\n\n    async function onYes() {\n        try {\n            console.log(data._id);\n            console.log(student._id);\n            const response = await axios.delete(\"/api/courses/student\", {\n                data: { courseId: data._id, studentId: student._id },\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n            });\n            \n\n            const updateUsers = data.users.filter(user => user._id !== student._id);\n            const updatedData = { ...data, users: updateUsers };\n            setData(updatedData);\n        } catch (err) {\n            switch (err.response.status) {\n                case 401 :\n                    setOpen(false);\n                    navigate(\"/sigin\", {replace: true});\n                    break;\n                case 404: \n                    setOpen(false);\n                    <ErrorMessagePopup message={\"Student/ course not found\"} />\n                    break;\n                default:\n                    setOpen(false);\n                    <ErrorMessagePopup message={\"\"} />\n                    break;\n            }\n        }\n    }\n\n    function onNo() {\n        setOpen(false);\n    }\n\n    return (\n        <div>\n            <button onClick={()=>setOpen(true)}>Delete</button>\n            {open && <ConfirmationPopup  message={\"Are you sure you want to delete this student ?\"}  onYes={onYes} onNo={onNo} />}\n        </div>\n    )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}